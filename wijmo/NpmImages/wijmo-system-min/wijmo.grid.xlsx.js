/*
    *
    * Wijmo Library 5.20173.380
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
System.register(["wijmo/wijmo.grid","wijmo/wijmo.xlsx","wijmo/wijmo","wijmo/wijmo.grid.xlsx"],function(e,o){"use strict";function l(){var e,o;return(e=window.wijmo)&&(o=e.grid)&&o.detail}function r(){var e,o;return(e=window.wijmo)&&(o=e.grid)&&o.multirow}var t,n,s,a,i,d,u=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)o.hasOwnProperty(l)&&(e[l]=o[l])};return function(o,l){function r(){this.constructor=o}e(o,l),o.prototype=null===l?Object.create(l):(r.prototype=l.prototype,new r)}}();o&&o.id;return{setters:[function(e){t=e},function(e){n=e},function(e){s=e},function(e){a=e}],execute:function(){window.wijmo=window.wijmo||{},window.wijmo.grid=window.wijmo.grid||{},window.wijmo.grid.xlsx=a,i=function(){function e(){}return e.save=function(e,o,l){var r=this._saveFlexGridToWorkbook(e,o);return l&&r.save(l),r},e.saveAsync=function(e,o,l,r,t){var n=this._saveFlexGridToWorkbook(e,o);return n.saveAsync(l,r,t),n},e.load=function(e,o,l){var r=this;if(o instanceof Blob){var t=new FileReader;t.onload=function(){var o=n.Workbook._base64EncArr(new Uint8Array(t.result)),s=new n.Workbook;s.load(o),o=null,e.deferUpdate(function(){r._loadToFlexGrid(e,s,l),s=null})},t.readAsArrayBuffer(o)}else if(o instanceof n.Workbook)e.deferUpdate(function(){r._loadToFlexGrid(e,o,l),o=null});else{if(o instanceof ArrayBuffer)o=n.Workbook._base64EncArr(new Uint8Array(o));else if(!s.isString(o))throw"Invalid workbook.";var a=new n.Workbook;a.load(o),o=null,e.deferUpdate(function(){r._loadToFlexGrid(e,a,l),a=null})}},e.loadAsync=function(e,o,l,r,t){var a=this;if(o instanceof Blob){var i=new FileReader;i.onload=function(){var o=n.Workbook._base64EncArr(new Uint8Array(i.result)),s=new n.Workbook;s.loadAsync(o,function(t){o=null,s=null,e.deferUpdate(function(){a._loadToFlexGrid(e,t,l),r&&r(t),t=null})},t)},i.readAsArrayBuffer(o)}else if(o instanceof n.Workbook)e.deferUpdate(function(){a._loadToFlexGrid(e,o,l),r&&r(o),o=null});else{if(o instanceof ArrayBuffer)o=n.Workbook._base64EncArr(new Uint8Array(o));else if(!s.isString(o))throw"Invalid workbook.";(new n.Workbook).loadAsync(o,function(t){o=null,e.deferUpdate(function(){a._loadToFlexGrid(e,t,l),r&&r(t),t=null})},t)}},e._saveFlexGridToWorkbook=function(e,o){var l,r,a,i,d,u,c,f,h,m,p,w,g,b=new n.Workbook,y=new n.WorkSheet,_=(new n.WorkbookStyle,new n.WorkbookFrozenPane),k=!o||null==o.includeColumnHeaders||o.includeColumnHeaders,v=!(!o||null==o.includeRowHeaders)&&o.includeRowHeaders,C=!o||null==o.includeCellStyles||o.includeCellStyles,S=o?o.activeWorksheet:null,x=o?o.includeColumns:null,W=o?o.formatItem:null,A=0,R=0,T=0,N=0;if(m=e.wj_sheetInfo,y.name=o?o.sheetName:"",y.visible=!o||!1!==o.sheetVisible,m&&m.tableNames&&m.tableNames.length>0)for(var B=0;B<m.tableNames.length;B++)y.tableNames.push(m.tableNames[B]);if(u=[],m||!C&&!W||((p=document.createElement("div")).style.visibility="hidden",p.setAttribute(t.FlexGrid._WJS_MEASURE,"true"),e.hostElement.appendChild(p)),v){for(f=0,c=0;c<e.rowHeaders.rows.length;c++)if(!(e.rowHeaders.rows[c].renderSize<=0)){for(u[f]=[],h=0;h<e.rowHeaders.columns.length;h++)a=e._getBindingColumn(e.rowHeaders,c,e.rowHeaders.columns[h]),i=this._getColumnSetting(a,e.columnHeaders.columns.defaultSize),u[f][h]=i,0===f&&((d=new n.WorkbookColumn)._deserialize(i),y._addWorkbookColumn(d,h));f++}N=h}if(k&&e.columnHeaders.rows.length>0){for(f=0,c=0;c<e.columnHeaders.rows.length;c++)if(!(e.columnHeaders.rows[c].renderSize<=0)){for(u[f]||(u[f]=[]),h=0;h<e.columnHeaders.columns.length;h++)a=e._getBindingColumn(e.columnHeaders,c,e.columnHeaders.columns[h]),i=this._getColumnSetting(a,e.columnHeaders.columns.defaultSize),u[f][N+h]=i,0===f&&(x&&!x(a)||((d=new n.WorkbookColumn)._deserialize(i),y._addWorkbookColumn(d)));N=0,l={},r=new n.WorkbookRow,v&&(N=this._parseFlexGridRowToSheetRow(e.topLeftCells,l,c,0,u,C,p,!1,0,x,W)),this._parseFlexGridRowToSheetRow(e.columnHeaders,l,c,N,u,C,p,!1,0,x,W),l.cells.length>0&&(r._deserialize(l),y._addWorkbookRow(r,f)),f++}R=f}else for(u[0]||(u[0]=[]),h=0;h<e.columnHeaders.columns.length;h++)a=e._getBindingColumn(e.columnHeaders,0,e.columnHeaders.columns[h]),i=this._getColumnSetting(a,e.columnHeaders.columns.defaultSize),u[0][N+h]=i,x&&!x(a)||((d=new n.WorkbookColumn)._deserialize(i),y._addWorkbookColumn(d));for(c=0;c<e.cells.rows.length;c++)N=0,l={},r=new n.WorkbookRow,(w=e.rows[c])instanceof t._NewRowTemplate||((g=w instanceof t.GroupRow)?A=s.tryCast(w,t.GroupRow).level:e.rows.maxGroupLevel>-1&&(A=e.rows.maxGroupLevel+1),v&&(N=this._parseFlexGridRowToSheetRow(e.rowHeaders,l,c,0,u,C,p,g,A,x,W)),this._parseFlexGridRowToSheetRow(e.cells,l,c,N,u,C,p,g,A,x,W),l.cells.length>0&&(r._deserialize(l),y._addWorkbookRow(r,R+c)));for(T=e.cells.rows.length,c=0;c<e.columnFooters.rows.length;c++)N=0,l={},r=new n.WorkbookRow,g=(w=e.columnFooters.rows[c])instanceof t.GroupRow,v&&(N=this._parseFlexGridRowToSheetRow(e.rowHeaders,l,c,0,u,C,p,g,0,x,W)),this._parseFlexGridRowToSheetRow(e.columnFooters,l,c,N,u,C,p,g,0,x,W),l.cells.length>0&&(r._deserialize(l),y._addWorkbookRow(r,R+T+c));return _.rows=k?e.frozenRows+R:e.frozenRows,_.columns=v?e.frozenColumns+N:e.frozenColumns,y.frozenPane=_,b._addWorkSheet(y),m||!C&&!W||e.hostElement.removeChild(p),b.activeWorksheet=S,b},e._loadToFlexGrid=function(e,o,l){var r,a,i,d,u,c,f,h,m,p,w,g,b,y,_,k,v,C,S,x,W,A,R,T,N,B,H,F,D,E,I,j,z,G=!l||null==l.includeColumnHeaders||l.includeColumnHeaders,L=!l||null==l.includeColumnHeaders||l.includeColumnHeaders,O=l&&null!=l.sheetIndex&&!isNaN(l.sheetIndex)?l.sheetIndex:0,M=l?l.sheetName:null,P=!l||l.sheetVisible,V=null!=e.wj_sheetInfo,U=0,X=0,$=!1,q={};if(e.itemsSource=null,e.columns.clear(),e.rows.clear(),e.frozenColumns=0,e.frozenRows=0,H={},F={},X=0,d=[],D=[],O<0||O>=o.sheets.length)throw"The sheet index option is out of the sheet range of current workbook.";if(null!=M)for(r=0;r<o.sheets.length;r++)if(M===o.sheets[r].name){g=o.sheets[r];break}if(null!=(g=g||o.sheets[O]).rows){for(G&&(X=1,g.rows.length<=1&&(L=!1,X=0),h=g.rows[0]),y=this._getColumnCount(g.rows),b=this._getRowCount(g.rows,y),S=g.summaryBelow,i=g.columns,U=0;U<y;U++)e.columns.push(new t.Column),i[U]&&(isNaN(+i[U].width)||(e.columns[U].width=+i[U].width),i[U].visible||void 0==i[U].visible||(e.columns[U].visible=!!i[U].visible),i[U].style&&i[U].style.wordWrap&&(e.columns[U].wordWrap=i[U].style.wordWrap));for(;X<b;X++){if(_=!1,z=null,w=g.rows[X])for(v=X+1;v<g.rows.length;){if(C=g.rows[v]){(isNaN(w.groupLevel)&&!isNaN(C.groupLevel)||!isNaN(w.groupLevel)&&w.groupLevel<C.groupLevel)&&(_=!0);break}v++}for(_&&!S?(W&&(W.isCollapsed=$),(W=new t.GroupRow).isReadOnly=!1,$=null!=w.collapsed&&w.collapsed,W.level=isNaN(w.groupLevel)?0:w.groupLevel,q[W.level]=$,this._checkParentCollapsed(q,W.level)&&W._setFlag(t.RowColFlags.ParentCollapsed,!0),e.rows.push(W)):(x=new t.Row,w&&this._checkParentCollapsed(q,w.groupLevel)&&x._setFlag(t.RowColFlags.ParentCollapsed,!0),e.rows.push(x)),w&&w.height&&!isNaN(w.height)&&(e.rows[L?X-1:X].height=w.height),U=0;U<y;U++)if(w){if(k=w.cells[U],(T=k?k.formula:void 0)&&"="!==T[0]&&(T="="+T),e.setCellData(L?X-1:X,U,T&&V?T:this._getItemValue(k)),_||this._setColumn(d,U,k),N=X*y+U,B=k?k.style:void 0,E=n.Workbook._parseExcelFormat(k),B){if(z=null==z?!!B.wordWrap:z&&!!B.wordWrap,I=this._getItemType(k),B.hAlign)j=n.Workbook._parseHAlignToString(s.asEnum(B.hAlign,n.HAlign));else switch(I){case s.DataType.Number:j="right";break;case s.DataType.Boolean:j="center";break;default:j=E&&0===E.search(/[n,c,p]/i)?"right":"left"}H[N]={fontWeight:B.font&&B.font.bold?"bold":"none",fontStyle:B.font&&B.font.italic?"italic":"none",textDecoration:B.font&&B.font.underline?"underline":"none",textAlign:j,fontFamily:B.font&&B.font.family?B.font.family:"",fontSize:B.font&&B.font.size?B.font.size+"px":"",color:B.font&&B.font.color?B.font.color:"",backgroundColor:B.fill&&B.fill.color?B.fill.color:"",whiteSpace:B.wordWrap?"pre-wrap":"normal",format:E},B.borders&&(B.borders.left&&(this._parseBorderStyle(B.borders.left.style,"Left",H[N]),H[N].borderLeftColor=B.borders.left.color),B.borders.right&&(this._parseBorderStyle(B.borders.right.style,"Right",H[N]),H[N].borderRightColor=B.borders.right.color),B.borders.top&&(this._parseBorderStyle(B.borders.top.style,"Top",H[N]),H[N].borderTopColor=B.borders.top.color),B.borders.bottom&&(this._parseBorderStyle(B.borders.bottom.style,"Bottom",H[N]),H[N].borderBottomColor=B.borders.bottom.color)),B.font&&-1===D.indexOf(B.font.family)&&D.push(B.font.family)}if(k&&s.isNumber(k.rowSpan)&&k.rowSpan>0&&s.isNumber(k.colSpan)&&k.colSpan>0&&(k.rowSpan>1||k.colSpan>1))for(r=X;r<X+k.rowSpan;r++)for(a=U;a<U+k.colSpan;a++)F[N=r*y+a]=new t.CellRange(X,U,X+k.rowSpan-1,U+k.colSpan-1)}else e.setCellData(L?X-1:X,U,""),this._setColumn(d,U,void 0);w&&(this._checkParentCollapsed(q,w.groupLevel)||w.visible||void 0==w.visible||(e.rows[L?X-1:X].visible=w.visible),e.rows[L?X-1:X].wordWrap=!!w.style&&!!w.style.wordWrap||!!z)}for(W&&(W.isCollapsed=$),g.frozenPane&&(A=g.frozenPane.columns,s.isNumber(A)&&!isNaN(A)&&(e.frozenColumns=A),R=g.frozenPane.rows,s.isNumber(R)&&!isNaN(R)&&(e.frozenRows=L&&R>0?R-1:R)),U=0;U<e.columnHeaders.columns.length;U++)u=d[U],(c=e.columns[U]).isRequired=!1,L&&(m=h?h.cells[U]:void 0)&&m.value?(p=n.Workbook._parseExcelFormat(m),f=s.Globalize.format(m.value,p)):f=this._numAlpha(U),c.header=f,u&&(u.dataType===s.DataType.Boolean&&(c.dataType=u.dataType),c.format=u.format,c.align=u.hAlign,c.wordWrap=c.wordWrap||!!u.wordWrap);V&&(e.wj_sheetInfo.name=g.name,e.wj_sheetInfo.visible=!0===P||!1!==g.visible,e.wj_sheetInfo.styledCells=H,e.wj_sheetInfo.mergedRanges=F,e.wj_sheetInfo.fonts=D,e.wj_sheetInfo.tableNames=g.tableNames)}},e._parseFlexGridRowToSheetRow=function(e,o,a,i,u,c,f,h,m,p,w){var g,b,y,_,k,v,C,S,x,W,A,R,T,N,B,H,F,D,E,I,j,z,G,L,O,M,P,V=!1;for(F=(g=e.grid).wj_sheetInfo,j=null!=(b=e.rows[a]).recordIndex?b.recordIndex:0,o.cells||(o.cells=[]),o.visible=b.isVisible,o.height=b.renderHeight||e.rows.defaultSize,o.groupLevel=m,h&&(o.collapsed=b.isCollapsed),b.wordWrap&&(o.style={wordWrap:b.wordWrap}),(b.constructor===t.Row||b.constructor===t._NewRowTemplate||l()&&b.constructor===l().DetailRow||r()&&b.constructor===r()._MultiRow)&&(V=!0),_=0;_<e.columns.length;_++)if(k=null,H=1,B=1,P=0,I=!1,T=null,O=null,E=g._getBindingColumn(e,a,e.columns[_]),N=null,F&&e===g.cells?(R=a*e.columns.length+_,F.mergedRanges&&(N=F.mergedRanges[R]),F.styledCells&&(T=F.styledCells[R])):c&&(L=f.cloneNode(),e.hostElement.children.length>0?e.hostElement.children[0].appendChild(L):e.hostElement.appendChild(L),T=(N=g.getMergedRange(e,a,_,!1))?this._getCellStyle(e,L,N.bottomRow,N.rightCol)||{}:this._getCellStyle(e,L,a,_)||{}),N||(N=g.getMergedRange(e,a,_,!1)),N?a===N.topRow&&_===N.leftCol&&(B=N.bottomRow-N.topRow+1,H=this._getColSpan(e,N,p),I=!0):I=!0,!p||p(E)){if(y=u[j][_+i],V||h?(C=I?e.getCellData(a,_,!0):null,S=I?e.getCellData(a,_,!1):null,W=!1,C&&s.isString(C)&&C.length>1&&"="===C[0]&&(W=!0),D=s.isDate(S),T&&T.format?(k=T.format,v=n.Workbook._parseCellFormat(T.format,D)):y&&y.style&&y.style.format?(k=E.format,v=y.style.format):v=null,v||(D?v="m/d/yyyy":s.isNumber(S)&&!E.dataMap?v=s.isInt(S)?"#,##0":"#,##0.00":W?(A=C.toLowerCase()).indexOf("now()")>-1?(v="m/d/yyyy h:mm",D=!0):A.indexOf("today()")>-1||A.indexOf("date(")>-1?(v="m/d/yyyy",D=!0):A.indexOf("time(")>-1&&(v="h:mm AM/PM",D=!0):v="General")):(C=I?g.columnHeaders.getCellData(0,_,!0):null,v="General"),O=this._parseCellStyle(T)||{},e===g.cells&&h&&b.hasChildren&&_===g.columns.firstVisibleIndex){if(C?x=C:I&&(x=b.getGroupHeader().replace(/<\/?\w+>/g,"")),null==x&&!T)continue;!(D=s.isDate(x))&&k&&"d"===k.toLowerCase()&&s.isInt(x)&&(v="0"),x="string"==typeof x?n.Workbook._unescapeXML(x):x,_===g.columns.firstVisibleIndex&&g.treeIndent&&(P=m),z={value:x,isDate:D,formula:W?this._parseToExcelFormula(C,D):null,colSpan:H,rowSpan:B,style:this._extend(O,{format:v,font:{bold:!0},hAlign:n.HAlign.Left,indent:P})}}else C="string"==typeof C?n.Workbook._unescapeXML(C):C,S="string"==typeof S?n.Workbook._unescapeXML(S):S,!D&&k&&"d"===k.toLowerCase()&&s.isInt(S)&&(v="0"),M=O&&O.hAlign?O.hAlign:y&&y.style&&null!=y.style.hAlign?s.asEnum(y.style.hAlign,n.HAlign,!0):s.isDate(S)?n.HAlign.Left:n.HAlign.General,_!==g.columns.firstVisibleIndex||!g.treeIndent||M!==n.HAlign.Left&&M!==n.HAlign.General||(P=m),z={value:W?null:"General"===v?s.isString(C)?C.replace(/^(\')(\s*=)/,"$2"):C:S,isDate:D,formula:W?this._parseToExcelFormula(C,D):null,colSpan:_<g.columns.firstVisibleIndex?1:H,rowSpan:B,style:this._extend(O,{format:v,hAlign:M,vAlign:B>1?e===g.cells||!1===g.centerHeadersVertically?n.VAlign.Top:n.VAlign.Center:null,indent:P})};w&&(w(G=new d(e,new t.CellRange(a,_),L,f,z)),L=G.cell),L&&(L.parentElement.removeChild(L),L=null),o.cells.push(z)}return i+_},e._parseCellStyle=function(e,o){if(void 0===o&&(o=!1),null==e)return null;var l=e.fontSize;l=l?+l.substring(0,l.indexOf("px")):null,isNaN(l)&&(l=null);var r=e.fontWeight;r="bold"===r||+r>=700;var t="italic"===e.fontStyle,s=e.textDecorationStyle;null==s&&(s=e.textDecoration),s="underline"===s;var a=e.whiteSpace;return a=!!a&&a.indexOf("pre")>-1,{font:{bold:r,italic:t,underline:s,family:this._parseToExcelFontFamily(e.fontFamily),size:l,color:e.color},fill:{color:e.backgroundColor},borders:this._parseBorder(e,o),hAlign:n.Workbook._parseStringToHAlign(e.textAlign),wordWrap:a}},e._parseBorder=function(e,o){var l={};return l.left=this._parseEgdeBorder(e,"Left"),l.right=this._parseEgdeBorder(e,"Right"),l.top=this._parseEgdeBorder(e,"Top"),l.bottom=this._parseEgdeBorder(e,"Bottom"),o&&(l.vertical=this._parseEgdeBorder(e,"Vertical"),l.horizontal=this._parseEgdeBorder(e,"Horizontal")),l},e._parseEgdeBorder=function(e,o){var l,r=e["border"+o+"Style"],t=e["border"+o+"Width"];if(t&&t.length>2&&(t=+t.substring(0,t.length-2)),r&&"none"!==r&&"hidden"!==r){switch(l={},r=r.toLowerCase()){case"dotted":l.style=t>1?n.BorderStyle.MediumDashDotted:n.BorderStyle.Dotted;break;case"dashed":l.style=t>1?n.BorderStyle.MediumDashed:n.BorderStyle.Dashed;break;case"double":l.style=n.BorderStyle.Double;break;default:l.style=t>2?n.BorderStyle.Thick:t>1?n.BorderStyle.Medium:n.BorderStyle.Thin}l.color=e["border"+o+"Color"]}return l},e._parseBorderStyle=function(e,o,l){var r="border"+o+"Style",t="border"+o+"Width";switch(e){case n.BorderStyle.Dotted:case n.BorderStyle.Hair:l[r]="dotted",l[t]="1px";break;case n.BorderStyle.Dashed:case n.BorderStyle.ThinDashDotDotted:case n.BorderStyle.ThinDashDotted:l[r]="dashed",l[t]="1px";break;case n.BorderStyle.MediumDashed:case n.BorderStyle.MediumDashDotDotted:case n.BorderStyle.MediumDashDotted:case n.BorderStyle.SlantedMediumDashDotted:l[r]="dashed",l[t]="2px";break;case n.BorderStyle.Double:l[r]="double",l[t]="3px";break;case n.BorderStyle.Medium:l[r]="solid",l[t]="2px";break;default:l[r]="solid",l[t]="1px"}},e._parseToExcelFontFamily=function(e){var o;return e&&(o=e.split(","))&&o.length>0&&(e=o[0].replace(/\"|\'/g,"")),e},e._parseToExcelFormula=function(e,o){var l,r,t,s,a,i,d,u=/(floor|ceiling)\([+-]?\d+\.?\d*\)/gi,c=/text\(\"?\w+\"?\s*\,\s*\"\w+\"\)/gi,f=/\"?\w+\"?\s*\,\s*\"(\w+)\"/i;if(l=e.match(u))for(a=0;a<l.length;a++)d=(i=l[a]).substring(0,i.lastIndexOf(")"))+", 1)",e=e.replace(i,d);if(l=null,l=e.match(c))for(a=0;a<l.length;a++)(r=(i=l[a]).match(f))&&2===r.length&&(t=r[1],/^d{1,4}?$/.test(t)||(s=n.Workbook._parseCellFormat(t,o),d=i.replace(t,s),e=e.replace(i,d)));return e},e._getColumnSetting=function(e,o){var l=e.renderWidth;return l=l||o,{autoWidth:!0,width:l,visible:e.visible,style:{format:e.format?n.Workbook._parseCellFormat(e.format,e.dataType===s.DataType.Date):"",hAlign:n.Workbook._parseStringToHAlign(this._toExcelHAlign(e.getAlignment())),wordWrap:e.wordWrap}}},e._toExcelHAlign=function(e){return(e=e?e.trim().toLowerCase():e)?e.indexOf("center")>-1?"center":e.indexOf("right")>-1||e.indexOf("end")>-1?"right":e.indexOf("justify")>-1?"justify":"left":e},e._getColumnCount=function(e){for(var o,l=0,r=0,t=0;t<e.length;t++)(o=e[t]&&e[t].cells?e[t].cells:[])&&o.length>0&&(r=o.length,s.isInt(o[r-1].colSpan)&&o[r-1].colSpan>1&&(r=r+o[r-1].colSpan-1),r>l&&(l=r));return l},e._getRowCount=function(e,o){for(var l,r,t,n=e.length,a=n-1,i=0;i<o;i++)e:for(;a>=0;a--)if(l=e[a],r=l&&l.cells?l.cells:[],(t=r[i])&&(null!=t.value&&""!==t.value||s.isInt(t.rowSpan)&&t.rowSpan>1)){s.isInt(t.rowSpan)&&t.rowSpan>1&&a+t.rowSpan>n&&(n=a+t.rowSpan);break e}return n},e._numAlpha=function(e){var o=Math.floor(e/26)-1;return(o>-1?this._numAlpha(o):"")+String.fromCharCode(65+e%26)},e._getItemType=function(e){if(void 0!==e&&null!==e&&void 0!==e.value&&null!==e.value&&!isNaN(e.value))return s.getType(e.value)},e._setColumn=function(e,o,l){var r,t,a,i=e[o];i?(r=this._getItemType(l),i.dataType!==r&&i.dataType===s.DataType.Boolean&&r!==s.DataType.Boolean&&(i.dataType=r),l&&null!=l.value&&""!==l.value&&(t=n.Workbook._parseExcelFormat(l))&&i.format!==t&&"General"!==t&&(i.format=t),l&&l.style&&(l.style.hAlign&&(a=n.Workbook._parseHAlignToString(s.asEnum(l.style.hAlign,n.HAlign))),null==i.wordWrap?i.wordWrap=!!l.style.wordWrap:i.wordWrap=i.wordWrap&&!!l.style.wordWrap),a||r!==s.DataType.Number||(a="right"),i.hAlign=a):e[o]={dataType:this._getItemType(l),format:n.Workbook._parseExcelFormat(l),hAlign:"",wordWrap:null}},e._getItemValue=function(e){if(void 0!==e&&null!==e&&void 0!==e.value&&null!==e.value){var o=e.value;return s.isNumber(o)&&isNaN(o)?"":o instanceof Date&&isNaN(o.getTime())?"":o}},e._getCellStyle=function(e,o,l,r){try{e.grid.cellFactory.updateCell(e,l,r,o),o.className=o.className.replace("wj-state-selected",""),o.className=o.className.replace("wj-state-multi-selected","")}catch(e){return null}return window.getComputedStyle(o)},e._extend=function(e,o){for(var l in o){var r=o[l];s.isObject(r)&&e[l]?s.copy(e[l],r):e[l]=r}return e},e._checkParentCollapsed=function(e,o){var l=!1;return Object.keys(e).forEach(function(r){!0===e[r]&&!1===l&&!isNaN(o)&&+r<o&&(l=!0)}),l},e._getColSpan=function(e,o,l){for(var r=0,t=o.leftCol;t<=o.rightCol;t++)l&&!l(e.columns[t])||r++;return r},e}(),e("FlexGridXlsxConverter",i),d=function(e){function o(o,l,r,t,n){var s=e.call(this,o,l)||this;return s._cell=r,s._patternCell=t,s._xlsxCell=n,s}return u(o,e),Object.defineProperty(o.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(e){this._xlsxCell=e},enumerable:!0,configurable:!0}),o.prototype.getFormattedCell=function(){return this._cell||(this._cell=this._patternCell.cloneNode(),this.panel.hostElement.children[0].appendChild(this._cell),i._getCellStyle(this.panel,this._cell,this.range.row,this.range.col)),this._cell},o}(t.CellRangeEventArgs),e("XlsxFormatItemEventArgs",d)}}});