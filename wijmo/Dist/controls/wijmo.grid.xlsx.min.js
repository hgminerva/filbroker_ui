/*
    *
    * Wijmo Library 5.20173.380
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)o.hasOwnProperty(l)&&(e[l]=o[l])};return function(o,l){function r(){this.constructor=o}e(o,l),o.prototype=null===l?Object.create(l):(r.prototype=l.prototype,new r)}}(),wijmo;!function(e){!function(o){!function(l){"use strict";var r=function(){function l(){}return l.save=function(e,o,l){var r=this._saveFlexGridToWorkbook(e,o);return l&&r.save(l),r},l.saveAsync=function(e,o,l,r,t){var n=this._saveFlexGridToWorkbook(e,o);return n.saveAsync(l,r,t),n},l.load=function(o,l,r){var t=this;if(l instanceof Blob){var n=new FileReader;n.onload=function(){var l=e.xlsx.Workbook._base64EncArr(new Uint8Array(n.result)),s=new e.xlsx.Workbook;s.load(l),l=null,o.deferUpdate(function(){t._loadToFlexGrid(o,s,r),s=null})},n.readAsArrayBuffer(l)}else if(l instanceof e.xlsx.Workbook)o.deferUpdate(function(){t._loadToFlexGrid(o,l,r),l=null});else{if(l instanceof ArrayBuffer)l=e.xlsx.Workbook._base64EncArr(new Uint8Array(l));else if(!e.isString(l))throw"Invalid workbook.";var s=new e.xlsx.Workbook;s.load(l),l=null,o.deferUpdate(function(){t._loadToFlexGrid(o,s,r),s=null})}},l.loadAsync=function(o,l,r,t,n){var s=this;if(l instanceof Blob){var a=new FileReader;a.onload=function(){var l=e.xlsx.Workbook._base64EncArr(new Uint8Array(a.result)),i=new e.xlsx.Workbook;i.loadAsync(l,function(e){l=null,i=null,o.deferUpdate(function(){s._loadToFlexGrid(o,e,r),t&&t(e),e=null})},n)},a.readAsArrayBuffer(l)}else if(l instanceof e.xlsx.Workbook)o.deferUpdate(function(){s._loadToFlexGrid(o,l,r),t&&t(l),l=null});else{if(l instanceof ArrayBuffer)l=e.xlsx.Workbook._base64EncArr(new Uint8Array(l));else if(!e.isString(l))throw"Invalid workbook.";(new e.xlsx.Workbook).loadAsync(l,function(e){l=null,o.deferUpdate(function(){s._loadToFlexGrid(o,e,r),t&&t(e),e=null})},n)}},l._saveFlexGridToWorkbook=function(l,r){var t,n,s,a,i,d,u,c,f,h,p,m,x,g=new e.xlsx.Workbook,w=new e.xlsx.WorkSheet,b=(new e.xlsx.WorkbookStyle,new e.xlsx.WorkbookFrozenPane),y=!r||null==r.includeColumnHeaders||r.includeColumnHeaders,_=!(!r||null==r.includeRowHeaders)&&r.includeRowHeaders,k=!r||null==r.includeCellStyles||r.includeCellStyles,v=r?r.activeWorksheet:null,C=r?r.includeColumns:null,S=r?r.formatItem:null,W=0,A=0,R=0,T=0;if(h=l.wj_sheetInfo,w.name=r?r.sheetName:"",w.visible=!r||!1!==r.sheetVisible,h&&h.tableNames&&h.tableNames.length>0)for(var N=0;N<h.tableNames.length;N++)w.tableNames.push(h.tableNames[N]);if(d=[],h||!k&&!S||((p=document.createElement("div")).style.visibility="hidden",p.setAttribute(o.FlexGrid._WJS_MEASURE,"true"),l.hostElement.appendChild(p)),_){for(c=0,u=0;u<l.rowHeaders.rows.length;u++)if(!(l.rowHeaders.rows[u].renderSize<=0)){for(d[c]=[],f=0;f<l.rowHeaders.columns.length;f++)s=l._getBindingColumn(l.rowHeaders,u,l.rowHeaders.columns[f]),a=this._getColumnSetting(s,l.columnHeaders.columns.defaultSize),d[c][f]=a,0===c&&((i=new e.xlsx.WorkbookColumn)._deserialize(a),w._addWorkbookColumn(i,f));c++}T=f}if(y&&l.columnHeaders.rows.length>0){for(c=0,u=0;u<l.columnHeaders.rows.length;u++)if(!(l.columnHeaders.rows[u].renderSize<=0)){for(d[c]||(d[c]=[]),f=0;f<l.columnHeaders.columns.length;f++)s=l._getBindingColumn(l.columnHeaders,u,l.columnHeaders.columns[f]),a=this._getColumnSetting(s,l.columnHeaders.columns.defaultSize),d[c][T+f]=a,0===c&&(C&&!C(s)||((i=new e.xlsx.WorkbookColumn)._deserialize(a),w._addWorkbookColumn(i)));T=0,t={},n=new e.xlsx.WorkbookRow,_&&(T=this._parseFlexGridRowToSheetRow(l.topLeftCells,t,u,0,d,k,p,!1,0,C,S)),this._parseFlexGridRowToSheetRow(l.columnHeaders,t,u,T,d,k,p,!1,0,C,S),t.cells.length>0&&(n._deserialize(t),w._addWorkbookRow(n,c)),c++}A=c}else for(d[0]||(d[0]=[]),f=0;f<l.columnHeaders.columns.length;f++)s=l._getBindingColumn(l.columnHeaders,0,l.columnHeaders.columns[f]),a=this._getColumnSetting(s,l.columnHeaders.columns.defaultSize),d[0][T+f]=a,C&&!C(s)||((i=new e.xlsx.WorkbookColumn)._deserialize(a),w._addWorkbookColumn(i));for(u=0;u<l.cells.rows.length;u++)T=0,t={},n=new e.xlsx.WorkbookRow,(m=l.rows[u])instanceof o._NewRowTemplate||((x=m instanceof o.GroupRow)?W=e.tryCast(m,o.GroupRow).level:l.rows.maxGroupLevel>-1&&(W=l.rows.maxGroupLevel+1),_&&(T=this._parseFlexGridRowToSheetRow(l.rowHeaders,t,u,0,d,k,p,x,W,C,S)),this._parseFlexGridRowToSheetRow(l.cells,t,u,T,d,k,p,x,W,C,S),t.cells.length>0&&(n._deserialize(t),w._addWorkbookRow(n,A+u)));for(R=l.cells.rows.length,u=0;u<l.columnFooters.rows.length;u++)T=0,t={},n=new e.xlsx.WorkbookRow,x=(m=l.columnFooters.rows[u])instanceof o.GroupRow,_&&(T=this._parseFlexGridRowToSheetRow(l.rowHeaders,t,u,0,d,k,p,x,0,C,S)),this._parseFlexGridRowToSheetRow(l.columnFooters,t,u,T,d,k,p,x,0,C,S),t.cells.length>0&&(n._deserialize(t),w._addWorkbookRow(n,A+R+u));return b.rows=y?l.frozenRows+A:l.frozenRows,b.columns=_?l.frozenColumns+T:l.frozenColumns,w.frozenPane=b,g._addWorkSheet(w),h||!k&&!S||l.hostElement.removeChild(p),g.activeWorksheet=v,g},l._loadToFlexGrid=function(l,r,t){var n,s,a,i,d,u,c,f,h,p,m,x,g,w,b,y,_,k,v,C,S,W,A,R,T,N,B,H,F,D,E,I,z,G=!t||null==t.includeColumnHeaders||t.includeColumnHeaders,L=!t||null==t.includeColumnHeaders||t.includeColumnHeaders,j=t&&null!=t.sheetIndex&&!isNaN(t.sheetIndex)?t.sheetIndex:0,O=t?t.sheetName:null,M=!t||t.sheetVisible,P=null!=l.wj_sheetInfo,V=0,U=0,X=!1,$={};if(l.itemsSource=null,l.columns.clear(),l.rows.clear(),l.frozenColumns=0,l.frozenRows=0,B={},H={},U=0,i=[],F=[],j<0||j>=r.sheets.length)throw"The sheet index option is out of the sheet range of current workbook.";if(null!=O)for(n=0;n<r.sheets.length;n++)if(O===r.sheets[n].name){x=r.sheets[n];break}if(null!=(x=x||r.sheets[j]).rows){for(G&&(U=1,x.rows.length<=1&&(L=!1,U=0),f=x.rows[0]),w=this._getColumnCount(x.rows),g=this._getRowCount(x.rows,w),v=x.summaryBelow,a=x.columns,V=0;V<w;V++)l.columns.push(new o.Column),a[V]&&(isNaN(+a[V].width)||(l.columns[V].width=+a[V].width),a[V].visible||void 0==a[V].visible||(l.columns[V].visible=!!a[V].visible),a[V].style&&a[V].style.wordWrap&&(l.columns[V].wordWrap=a[V].style.wordWrap));for(;U<g;U++){if(b=!1,z=null,m=x.rows[U])for(_=U+1;_<x.rows.length;){if(k=x.rows[_]){(isNaN(m.groupLevel)&&!isNaN(k.groupLevel)||!isNaN(m.groupLevel)&&m.groupLevel<k.groupLevel)&&(b=!0);break}_++}for(b&&!v?(S&&(S.isCollapsed=X),(S=new o.GroupRow).isReadOnly=!1,X=null!=m.collapsed&&m.collapsed,S.level=isNaN(m.groupLevel)?0:m.groupLevel,$[S.level]=X,this._checkParentCollapsed($,S.level)&&S._setFlag(o.RowColFlags.ParentCollapsed,!0),l.rows.push(S)):(C=new o.Row,m&&this._checkParentCollapsed($,m.groupLevel)&&C._setFlag(o.RowColFlags.ParentCollapsed,!0),l.rows.push(C)),m&&m.height&&!isNaN(m.height)&&(l.rows[L?U-1:U].height=m.height),V=0;V<w;V++)if(m){if(y=m.cells[V],(R=y?y.formula:void 0)&&"="!==R[0]&&(R="="+R),l.setCellData(L?U-1:U,V,R&&P?R:this._getItemValue(y)),b||this._setColumn(i,V,y),T=U*w+V,N=y?y.style:void 0,D=e.xlsx.Workbook._parseExcelFormat(y),N){if(z=null==z?!!N.wordWrap:z&&!!N.wordWrap,E=this._getItemType(y),N.hAlign)I=e.xlsx.Workbook._parseHAlignToString(e.asEnum(N.hAlign,e.xlsx.HAlign));else switch(E){case e.DataType.Number:I="right";break;case e.DataType.Boolean:I="center";break;default:I=D&&0===D.search(/[n,c,p]/i)?"right":"left"}B[T]={fontWeight:N.font&&N.font.bold?"bold":"none",fontStyle:N.font&&N.font.italic?"italic":"none",textDecoration:N.font&&N.font.underline?"underline":"none",textAlign:I,fontFamily:N.font&&N.font.family?N.font.family:"",fontSize:N.font&&N.font.size?N.font.size+"px":"",color:N.font&&N.font.color?N.font.color:"",backgroundColor:N.fill&&N.fill.color?N.fill.color:"",whiteSpace:N.wordWrap?"pre-wrap":"normal",format:D},N.borders&&(N.borders.left&&(this._parseBorderStyle(N.borders.left.style,"Left",B[T]),B[T].borderLeftColor=N.borders.left.color),N.borders.right&&(this._parseBorderStyle(N.borders.right.style,"Right",B[T]),B[T].borderRightColor=N.borders.right.color),N.borders.top&&(this._parseBorderStyle(N.borders.top.style,"Top",B[T]),B[T].borderTopColor=N.borders.top.color),N.borders.bottom&&(this._parseBorderStyle(N.borders.bottom.style,"Bottom",B[T]),B[T].borderBottomColor=N.borders.bottom.color)),N.font&&-1===F.indexOf(N.font.family)&&F.push(N.font.family)}if(y&&e.isNumber(y.rowSpan)&&y.rowSpan>0&&e.isNumber(y.colSpan)&&y.colSpan>0&&(y.rowSpan>1||y.colSpan>1))for(n=U;n<U+y.rowSpan;n++)for(s=V;s<V+y.colSpan;s++)H[T=n*w+s]=new o.CellRange(U,V,U+y.rowSpan-1,V+y.colSpan-1)}else l.setCellData(L?U-1:U,V,""),this._setColumn(i,V,void 0);m&&(this._checkParentCollapsed($,m.groupLevel)||m.visible||void 0==m.visible||(l.rows[L?U-1:U].visible=m.visible),l.rows[L?U-1:U].wordWrap=!!m.style&&!!m.style.wordWrap||!!z)}for(S&&(S.isCollapsed=X),x.frozenPane&&(W=x.frozenPane.columns,e.isNumber(W)&&!isNaN(W)&&(l.frozenColumns=W),A=x.frozenPane.rows,e.isNumber(A)&&!isNaN(A)&&(l.frozenRows=L&&A>0?A-1:A)),V=0;V<l.columnHeaders.columns.length;V++)d=i[V],(u=l.columns[V]).isRequired=!1,L&&(h=f?f.cells[V]:void 0)&&h.value?(p=e.xlsx.Workbook._parseExcelFormat(h),c=e.Globalize.format(h.value,p)):c=this._numAlpha(V),u.header=c,d&&(d.dataType===e.DataType.Boolean&&(u.dataType=d.dataType),u.format=d.format,u.align=d.hAlign,u.wordWrap=u.wordWrap||!!d.wordWrap);P&&(l.wj_sheetInfo.name=x.name,l.wj_sheetInfo.visible=!0===M||!1!==x.visible,l.wj_sheetInfo.styledCells=B,l.wj_sheetInfo.mergedRanges=H,l.wj_sheetInfo.fonts=F,l.wj_sheetInfo.tableNames=x.tableNames)}},l._parseFlexGridRowToSheetRow=function(l,r,n,s,a,i,d,u,c,f,h){var p,m,x,g,w,b,y,_,k,v,C,S,W,A,R,T,N,B,H,F,D,E,I,z,G,L,j,O=!1;for(N=(p=l.grid).wj_sheetInfo,D=null!=(m=l.rows[n]).recordIndex?m.recordIndex:0,r.cells||(r.cells=[]),r.visible=m.isVisible,r.height=m.renderHeight||l.rows.defaultSize,r.groupLevel=c,u&&(r.collapsed=m.isCollapsed),m.wordWrap&&(r.style={wordWrap:m.wordWrap}),(m.constructor===e.grid.Row||m.constructor===e.grid._NewRowTemplate||e.grid.detail&&m.constructor===e.grid.detail.DetailRow||e.grid.multirow&&m.constructor===e.grid.multirow._MultiRow)&&(O=!0),g=0;g<l.columns.length;g++)if(w=null,T=1,R=1,j=0,F=!1,W=null,G=null,H=p._getBindingColumn(l,n,l.columns[g]),A=null,N&&l===p.cells?(S=n*l.columns.length+g,N.mergedRanges&&(A=N.mergedRanges[S]),N.styledCells&&(W=N.styledCells[S])):i&&(z=d.cloneNode(),l.hostElement.children.length>0?l.hostElement.children[0].appendChild(z):l.hostElement.appendChild(z),W=(A=p.getMergedRange(l,n,g,!1))?this._getCellStyle(l,z,A.bottomRow,A.rightCol)||{}:this._getCellStyle(l,z,n,g)||{}),A||(A=p.getMergedRange(l,n,g,!1)),A?n===A.topRow&&g===A.leftCol&&(R=A.bottomRow-A.topRow+1,T=this._getColSpan(l,A,f),F=!0):F=!0,!f||f(H)){if(x=a[D][g+s],O||u?(y=F?l.getCellData(n,g,!0):null,_=F?l.getCellData(n,g,!1):null,v=!1,y&&e.isString(y)&&y.length>1&&"="===y[0]&&(v=!0),B=e.isDate(_),W&&W.format?(w=W.format,b=e.xlsx.Workbook._parseCellFormat(W.format,B)):x&&x.style&&x.style.format?(w=H.format,b=x.style.format):b=null,b||(B?b="m/d/yyyy":e.isNumber(_)&&!H.dataMap?b=e.isInt(_)?"#,##0":"#,##0.00":v?(C=y.toLowerCase()).indexOf("now()")>-1?(b="m/d/yyyy h:mm",B=!0):C.indexOf("today()")>-1||C.indexOf("date(")>-1?(b="m/d/yyyy",B=!0):C.indexOf("time(")>-1&&(b="h:mm AM/PM",B=!0):b="General")):(y=F?p.columnHeaders.getCellData(0,g,!0):null,b="General"),G=this._parseCellStyle(W)||{},l===p.cells&&u&&m.hasChildren&&g===p.columns.firstVisibleIndex){if(y?k=y:F&&(k=m.getGroupHeader().replace(/<\/?\w+>/g,"")),null==k&&!W)continue;!(B=e.isDate(k))&&w&&"d"===w.toLowerCase()&&e.isInt(k)&&(b="0"),k="string"==typeof k?e.xlsx.Workbook._unescapeXML(k):k,g===p.columns.firstVisibleIndex&&p.treeIndent&&(j=c),E={value:k,isDate:B,formula:v?this._parseToExcelFormula(y,B):null,colSpan:T,rowSpan:R,style:this._extend(G,{format:b,font:{bold:!0},hAlign:e.xlsx.HAlign.Left,indent:j})}}else y="string"==typeof y?e.xlsx.Workbook._unescapeXML(y):y,_="string"==typeof _?e.xlsx.Workbook._unescapeXML(_):_,!B&&w&&"d"===w.toLowerCase()&&e.isInt(_)&&(b="0"),L=G&&G.hAlign?G.hAlign:x&&x.style&&null!=x.style.hAlign?e.asEnum(x.style.hAlign,e.xlsx.HAlign,!0):e.isDate(_)?e.xlsx.HAlign.Left:e.xlsx.HAlign.General,g!==p.columns.firstVisibleIndex||!p.treeIndent||L!==e.xlsx.HAlign.Left&&L!==e.xlsx.HAlign.General||(j=c),E={value:v?null:"General"===b?e.isString(y)?y.replace(/^(\')(\s*=)/,"$2"):y:_,isDate:B,formula:v?this._parseToExcelFormula(y,B):null,colSpan:g<p.columns.firstVisibleIndex?1:T,rowSpan:R,style:this._extend(G,{format:b,hAlign:L,vAlign:R>1?l===p.cells||!1===p.centerHeadersVertically?e.xlsx.VAlign.Top:e.xlsx.VAlign.Center:null,indent:j})};h&&(h(I=new t(l,new o.CellRange(n,g),z,d,E)),z=I.cell),z&&(z.parentElement.removeChild(z),z=null),r.cells.push(E)}return s+g},l._parseCellStyle=function(o,l){if(void 0===l&&(l=!1),null==o)return null;var r=o.fontSize;r=r?+r.substring(0,r.indexOf("px")):null,isNaN(r)&&(r=null);var t=o.fontWeight;t="bold"===t||+t>=700;var n="italic"===o.fontStyle,s=o.textDecorationStyle;null==s&&(s=o.textDecoration),s="underline"===s;var a=o.whiteSpace;return a=!!a&&a.indexOf("pre")>-1,{font:{bold:t,italic:n,underline:s,family:this._parseToExcelFontFamily(o.fontFamily),size:r,color:o.color},fill:{color:o.backgroundColor},borders:this._parseBorder(o,l),hAlign:e.xlsx.Workbook._parseStringToHAlign(o.textAlign),wordWrap:a}},l._parseBorder=function(e,o){var l={};return l.left=this._parseEgdeBorder(e,"Left"),l.right=this._parseEgdeBorder(e,"Right"),l.top=this._parseEgdeBorder(e,"Top"),l.bottom=this._parseEgdeBorder(e,"Bottom"),o&&(l.vertical=this._parseEgdeBorder(e,"Vertical"),l.horizontal=this._parseEgdeBorder(e,"Horizontal")),l},l._parseEgdeBorder=function(o,l){var r,t=o["border"+l+"Style"],n=o["border"+l+"Width"];if(n&&n.length>2&&(n=+n.substring(0,n.length-2)),t&&"none"!==t&&"hidden"!==t){switch(r={},t=t.toLowerCase()){case"dotted":r.style=n>1?e.xlsx.BorderStyle.MediumDashDotted:e.xlsx.BorderStyle.Dotted;break;case"dashed":r.style=n>1?e.xlsx.BorderStyle.MediumDashed:e.xlsx.BorderStyle.Dashed;break;case"double":r.style=e.xlsx.BorderStyle.Double;break;default:r.style=n>2?e.xlsx.BorderStyle.Thick:n>1?e.xlsx.BorderStyle.Medium:e.xlsx.BorderStyle.Thin}r.color=o["border"+l+"Color"]}return r},l._parseBorderStyle=function(o,l,r){var t="border"+l+"Style",n="border"+l+"Width";switch(o){case e.xlsx.BorderStyle.Dotted:case e.xlsx.BorderStyle.Hair:r[t]="dotted",r[n]="1px";break;case e.xlsx.BorderStyle.Dashed:case e.xlsx.BorderStyle.ThinDashDotDotted:case e.xlsx.BorderStyle.ThinDashDotted:r[t]="dashed",r[n]="1px";break;case e.xlsx.BorderStyle.MediumDashed:case e.xlsx.BorderStyle.MediumDashDotDotted:case e.xlsx.BorderStyle.MediumDashDotted:case e.xlsx.BorderStyle.SlantedMediumDashDotted:r[t]="dashed",r[n]="2px";break;case e.xlsx.BorderStyle.Double:r[t]="double",r[n]="3px";break;case e.xlsx.BorderStyle.Medium:r[t]="solid",r[n]="2px";break;default:r[t]="solid",r[n]="1px"}},l._parseToExcelFontFamily=function(e){var o;return e&&(o=e.split(","))&&o.length>0&&(e=o[0].replace(/\"|\'/g,"")),e},l._parseToExcelFormula=function(o,l){var r,t,n,s,a,i,d,u=/(floor|ceiling)\([+-]?\d+\.?\d*\)/gi,c=/text\(\"?\w+\"?\s*\,\s*\"\w+\"\)/gi,f=/\"?\w+\"?\s*\,\s*\"(\w+)\"/i;if(r=o.match(u))for(a=0;a<r.length;a++)d=(i=r[a]).substring(0,i.lastIndexOf(")"))+", 1)",o=o.replace(i,d);if(r=null,r=o.match(c))for(a=0;a<r.length;a++)(t=(i=r[a]).match(f))&&2===t.length&&(n=t[1],/^d{1,4}?$/.test(n)||(s=e.xlsx.Workbook._parseCellFormat(n,l),d=i.replace(n,s),o=o.replace(i,d)));return o},l._getColumnSetting=function(o,l){var r=o.renderWidth;return r=r||l,{autoWidth:!0,width:r,visible:o.visible,style:{format:o.format?e.xlsx.Workbook._parseCellFormat(o.format,o.dataType===e.DataType.Date):"",hAlign:e.xlsx.Workbook._parseStringToHAlign(this._toExcelHAlign(o.getAlignment())),wordWrap:o.wordWrap}}},l._toExcelHAlign=function(e){return(e=e?e.trim().toLowerCase():e)?e.indexOf("center")>-1?"center":e.indexOf("right")>-1||e.indexOf("end")>-1?"right":e.indexOf("justify")>-1?"justify":"left":e},l._getColumnCount=function(o){for(var l,r=0,t=0,n=0;n<o.length;n++)(l=o[n]&&o[n].cells?o[n].cells:[])&&l.length>0&&(t=l.length,e.isInt(l[t-1].colSpan)&&l[t-1].colSpan>1&&(t=t+l[t-1].colSpan-1),t>r&&(r=t));return r},l._getRowCount=function(o,l){for(var r,t,n,s=o.length,a=s-1,i=0;i<l;i++)e:for(;a>=0;a--)if(r=o[a],t=r&&r.cells?r.cells:[],(n=t[i])&&(null!=n.value&&""!==n.value||e.isInt(n.rowSpan)&&n.rowSpan>1)){e.isInt(n.rowSpan)&&n.rowSpan>1&&a+n.rowSpan>s&&(s=a+n.rowSpan);break e}return s},l._numAlpha=function(e){var o=Math.floor(e/26)-1;return(o>-1?this._numAlpha(o):"")+String.fromCharCode(65+e%26)},l._getItemType=function(o){if(void 0!==o&&null!==o&&void 0!==o.value&&null!==o.value&&!isNaN(o.value))return e.getType(o.value)},l._setColumn=function(o,l,r){var t,n,s,a=o[l];a?(t=this._getItemType(r),a.dataType!==t&&a.dataType===e.DataType.Boolean&&t!==e.DataType.Boolean&&(a.dataType=t),r&&null!=r.value&&""!==r.value&&(n=e.xlsx.Workbook._parseExcelFormat(r))&&a.format!==n&&"General"!==n&&(a.format=n),r&&r.style&&(r.style.hAlign&&(s=e.xlsx.Workbook._parseHAlignToString(e.asEnum(r.style.hAlign,e.xlsx.HAlign))),null==a.wordWrap?a.wordWrap=!!r.style.wordWrap:a.wordWrap=a.wordWrap&&!!r.style.wordWrap),s||t!==e.DataType.Number||(s="right"),a.hAlign=s):o[l]={dataType:this._getItemType(r),format:e.xlsx.Workbook._parseExcelFormat(r),hAlign:"",wordWrap:null}},l._getItemValue=function(o){if(void 0!==o&&null!==o&&void 0!==o.value&&null!==o.value){var l=o.value;return e.isNumber(l)&&isNaN(l)?"":l instanceof Date&&isNaN(l.getTime())?"":l}},l._getCellStyle=function(e,o,l,r){try{e.grid.cellFactory.updateCell(e,l,r,o),o.className=o.className.replace("wj-state-selected",""),o.className=o.className.replace("wj-state-multi-selected","")}catch(e){return null}return window.getComputedStyle(o)},l._extend=function(o,l){for(var r in l){var t=l[r];e.isObject(t)&&o[r]?e.copy(o[r],t):o[r]=t}return o},l._checkParentCollapsed=function(e,o){var l=!1;return Object.keys(e).forEach(function(r){!0===e[r]&&!1===l&&!isNaN(o)&&+r<o&&(l=!0)}),l},l._getColSpan=function(e,o,l){for(var r=0,t=o.leftCol;t<=o.rightCol;t++)l&&!l(e.columns[t])||r++;return r},l}();l.FlexGridXlsxConverter=r;var t=function(e){function o(o,l,r,t,n){var s=e.call(this,o,l)||this;return s._cell=r,s._patternCell=t,s._xlsxCell=n,s}return __extends(o,e),Object.defineProperty(o.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(e){this._xlsxCell=e},enumerable:!0,configurable:!0}),o.prototype.getFormattedCell=function(){return this._cell||(this._cell=this._patternCell.cloneNode(),this.panel.hostElement.children[0].appendChild(this._cell),r._getCellStyle(this.panel,this._cell,this.range.row,this.range.col)),this._cell},o}(e.grid.CellRangeEventArgs);l.XlsxFormatItemEventArgs=t}(o.xlsx||(o.xlsx={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));