/*!
    *
    * Wijmo Library 5.20192.631
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var e=function(l,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,l){e.__proto__=l}||function(e,l){for(var o in l)l.hasOwnProperty(o)&&(e[o]=l[o])})(l,o)};return function(l,o){function t(){this.constructor=l}e(l,o),l.prototype=null===o?Object.create(o):(t.prototype=o.prototype,new t)}}();!function(e){!function(l){!function(l){l.softDetail=function(){return e._getModule("wijmo.grid.detail")},l.softMultiRow=function(){return e._getModule("wijmo.grid.multirow")}}(l.xlsx||(l.xlsx={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={})),function(e){var l;(function(l){"use strict";var o=function(){function o(){}return o.save=function(e,l,o){var t=this._saveFlexGridToWorkbook(e,l);return o&&t.save(o),t},o.saveAsync=function(e,l,o,t,r){var n=this._saveFlexGridToWorkbook(e,l);return o&&n.saveAsync(o,t,r),n},o.load=function(l,o,t){var r=this;if(o instanceof Blob){var n=new FileReader;n.onload=function(){var o=e.xlsx.Workbook._base64EncArr(new Uint8Array(n.result)),s=new e.xlsx.Workbook;s.load(o),o=null,l.deferUpdate(function(){r._loadToFlexGrid(l,s,t),s=null})},n.readAsArrayBuffer(o)}else if(o instanceof e.xlsx.Workbook)l.deferUpdate(function(){r._loadToFlexGrid(l,o,t),o=null});else{if(o instanceof ArrayBuffer)o=e.xlsx.Workbook._base64EncArr(new Uint8Array(o));else if(!e.isString(o))throw"Invalid workbook.";var s=new e.xlsx.Workbook;s.load(o),o=null,l.deferUpdate(function(){r._loadToFlexGrid(l,s,t),s=null})}},o.loadAsync=function(l,o,t,r,n){var s=this;if(o instanceof Blob){var i=new FileReader;i.onload=function(){var o=e.xlsx.Workbook._base64EncArr(new Uint8Array(i.result)),a=new e.xlsx.Workbook;a.loadAsync(o,function(e){o=null,a=null,l.deferUpdate(function(){s._loadToFlexGrid(l,e,t),r&&r(e),e=null})},n)},i.readAsArrayBuffer(o)}else if(o instanceof e.xlsx.Workbook)l.deferUpdate(function(){s._loadToFlexGrid(l,o,t),r&&r(o),o=null});else{if(o instanceof ArrayBuffer)o=e.xlsx.Workbook._base64EncArr(new Uint8Array(o));else if(!e.isString(o))throw"Invalid workbook.";(new e.xlsx.Workbook).loadAsync(o,function(e){o=null,l.deferUpdate(function(){s._loadToFlexGrid(l,e,t),r&&r(e),e=null})},n)}},o._saveFlexGridToWorkbook=function(l,o){var t,r,n,s,i,a,u,d,c,f,h,g,x,p,m=new e.xlsx.Workbook,w=new e.xlsx.WorkSheet,b=(new e.xlsx.WorkbookStyle,new e.xlsx.WorkbookFrozenPane),y=!o||null==o.includeColumnHeaders||o.includeColumnHeaders,_=!(!o||null==o.includeRowHeaders)&&o.includeRowHeaders,v=!o||null==o.includeCellStyles||o.includeCellStyles,C=o?o.activeWorksheet:null,k=o?o.includeColumns:null,S=o?o.formatItem:null,T=0,R=0,W=0,A=[];if(null==this.hasCssText&&(this.hasCssText="cssText"in document.body.style),f=l.wj_sheetInfo,w.name=o?o.sheetName:"",w.visible=!o||!1!==o.sheetVisible,f&&f.tables&&f.tables.length>0)for(var H=0;H<f.tables.length;H++)w.tables.push(f.tables[H]);if(a=[],f||!v&&!S||((h=document.createElement("div")).style.visibility="hidden",h.setAttribute(e.grid.FlexGrid._WJS_MEASURE,"true"),l.hostElement.appendChild(h)),_){for(d=0,u=0;u<l.rowHeaders.rows.length;u++)if(!(l.rowHeaders.rows[u].renderSize<=0)){for(a[d]=[],c=0;c<l.rowHeaders.columns.length;c++)n=l._getBindingColumn(l.rowHeaders,u,l.rowHeaders.columns[c]),(s=this._getColumnSetting(n,c,l.columnHeaders.columns))&&(a[d][c]=s,0===d&&((i=new e.xlsx.WorkbookColumn)._deserialize(s),w._addWorkbookColumn(i,c)));d++}W=c}if(l.columnHeaders.rows.length>0){for(d=0,u=0;u<l.columnHeaders.rows.length;u++)if(!(l.columnHeaders.rows[u].renderSize<=0)){a[d]||(a[d]=[]);for(var F=0,D=0;F<l.columnHeaders.columns.length;F++)n=l._getBindingColumn(l.columnHeaders,u,l.columnHeaders.columns[F]),(s=this._getColumnSetting(n,F,l.columnHeaders.columns))&&(a[d][W+F]=s,0===d&&(k&&!k(n)||((i=new e.xlsx.WorkbookColumn)._deserialize(s),w._addWorkbookColumn(i,W+D++))));y&&(W=0,t={},r=new e.xlsx.WorkbookRow,_&&(W=this._parseFlexGridRowToSheetRow(l.topLeftCells,t,u,0,a,v,h,A,!1,0,k,S)),this._parseFlexGridRowToSheetRow(l.columnHeaders,t,u,W,a,v,h,A,!1,0,k,S),t.cells.length>0&&(r._deserialize(t),w._addWorkbookRow(r,d))),d++}R=y?d:0}for(u=0;u<l.cells.rows.length;u++)W=0,t={},r=new e.xlsx.WorkbookRow,(g=l.rows[u])instanceof e.grid._NewRowTemplate||((x=g instanceof e.grid.GroupRow)?T=e.tryCast(g,e.grid.GroupRow).level:l.rows.maxGroupLevel>-1&&(T=l.rows.maxGroupLevel+1),_&&(W=this._parseFlexGridRowToSheetRow(l.rowHeaders,t,u,0,a,v,h,A,x,T,k,S)),this._parseFlexGridRowToSheetRow(l.cells,t,u,W,a,v,h,A,x,T,k,S),t.cells.length>0&&(r._deserialize(t),w._addWorkbookRow(r,R+u)));for(p=l.cells.rows.length,u=0;u<l.columnFooters.rows.length;u++)W=0,t={},r=new e.xlsx.WorkbookRow,x=(g=l.columnFooters.rows[u])instanceof e.grid.GroupRow,_&&(W=this._parseFlexGridRowToSheetRow(l.rowHeaders,t,u,0,a,v,h,A,x,0,k,S)),this._parseFlexGridRowToSheetRow(l.columnFooters,t,u,W,a,v,h,A,x,0,k,S),t.cells.length>0&&(r._deserialize(t),w._addWorkbookRow(r,R+p+u));return b.rows=y?l.frozenRows+R:l.frozenRows,b.columns=_?l.frozenColumns+W:l.frozenColumns,w.frozenPane=b,m._addWorkSheet(w),f||!v&&!S||(l.hostElement.removeChild(h),A.forEach(function(e){return e.forEach(function(e){e&&e.parentElement&&e.parentElement.removeChild(e)})})),m.activeWorksheet=C,m},o._loadToFlexGrid=function(l,o,t){t=t||{};var r,n=null!=l.wj_sheetInfo,s={},i=[],a=[],u={};l.itemsSource=null,l.columns.clear(),l.columnHeaders.rows.clear(),l.rows.clear(),l.frozenColumns=0,l.frozenRows=0;var d=null==t.sheetIndex||isNaN(t.sheetIndex)?0:t.sheetIndex;if(d<0||d>=o.sheets.length)throw"The sheet index option is out of the sheet range of current workbook.";if(null!=t.sheetName)for(var c=0;c<o.sheets.length;c++)if(t.sheetName===o.sheets[c].name){r=o.sheets[c];break}if(null!=(r=r||o.sheets[d]).rows){for(var f=this._getColumnCount(r.rows),h=this._getRowCount(r.rows,f),g=r.columns,x=0;x<f;x++)l.columns.push(new e.grid.Column),g[x]&&(isNaN(+g[x].width)||(l.columns[x].width=+g[x].width),g[x].visible||null==g[x].visible||(l.columns[x].visible=!!g[x].visible),g[x].style&&g[x].style.wordWrap&&(l.columns[x].wordWrap=g[x].style.wordWrap));for(var p,m=(null==t.includeColumnHeaders||t.includeColumnHeaders)&&r.rows.length>0,w=m?this._getColumnHeadersHeight(r):0,b=!1,y=[],_=w;_<h;_++){var v=!1,C=null,k=r.rows[_];if(k)for(var S=_+1;S<r.rows.length;){var T=r.rows[S];if(T){(isNaN(k.groupLevel)&&!isNaN(T.groupLevel)||!isNaN(k.groupLevel)&&k.groupLevel<T.groupLevel)&&(v=!0);break}S++}if(v&&!r.summaryBelow)p&&(p.isCollapsed=b),(p=new e.grid.GroupRow).isReadOnly=!1,b=null!=k.collapsed&&k.collapsed,p.level=isNaN(k.groupLevel)?0:k.groupLevel,u[p.level]=b,this._checkParentCollapsed(u,p.level)&&p._setFlag(e.grid.RowColFlags.ParentCollapsed,!0),l.rows.push(p);else{var R=new e.grid.Row;k&&this._checkParentCollapsed(u,k.groupLevel)&&R._setFlag(e.grid.RowColFlags.ParentCollapsed,!0),l.rows.push(R)}for(k&&k.height&&!isNaN(k.height)&&(l.rows[_-w].height=k.height),x=0;x<f;x++)if(k){var W=k.cells[x],A=W?W.formula:null;A&&"="!==A[0]&&(A="="+A),W&&W.textRuns&&W.textRuns.length>0?(l.rows[_-w].isContentHtml=!0,l.setCellData(_-w,x,this._parseTextRunsToHTML(W.textRuns))):l.setCellData(_-w,x,A&&n?A:this._getItemValue(W)),v||this._setColumn(y,x,W);var H=_*f+x,F=W?W.style:null,D=e.xlsx.Workbook._parseExcelFormat(W),B=void 0;if(F){if(C=null==C?!!F.wordWrap:C&&!!F.wordWrap,F.hAlign)B=e.xlsx.Workbook._parseHAlignToString(e.asEnum(F.hAlign,e.xlsx.HAlign));else switch(this._getItemType(W)){case e.DataType.Number:B="right";break;case e.DataType.Boolean:B="center";break;default:B=D&&0===D.search(/[n,c,p]/i)?"right":"left"}s[H]={fontWeight:F.font&&F.font.bold?"bold":"none",fontStyle:F.font&&F.font.italic?"italic":"none",textDecoration:F.font&&F.font.underline?"underline":"none",textAlign:B,fontFamily:F.font&&F.font.family?F.font.family:"",fontSize:F.font&&F.font.size?F.font.size+"px":"",color:F.font&&F.font.color?F.font.color:"",backgroundColor:F.fill&&F.fill.color?F.fill.color:"",whiteSpace:F.wordWrap?"pre-wrap":"normal",format:D},F.borders&&(F.borders.left&&(this._parseBorderStyle(F.borders.left.style,"Left",s[H]),s[H].borderLeftColor=F.borders.left.color),F.borders.right&&(this._parseBorderStyle(F.borders.right.style,"Right",s[H]),s[H].borderRightColor=F.borders.right.color),F.borders.top&&(this._parseBorderStyle(F.borders.top.style,"Top",s[H]),s[H].borderTopColor=F.borders.top.color),F.borders.bottom&&(this._parseBorderStyle(F.borders.bottom.style,"Bottom",s[H]),s[H].borderBottomColor=F.borders.bottom.color)),F.font&&-1===a.indexOf(F.font.family)&&a.push(F.font.family)}W&&e.isNumber(W.rowSpan)&&W.rowSpan>0&&e.isNumber(W.colSpan)&&W.colSpan>0&&(W.rowSpan>1||W.colSpan>1)&&i.push(new e.grid.CellRange(_,x,_+W.rowSpan-1,x+W.colSpan-1))}k&&(this._checkParentCollapsed(u,k.groupLevel)||k.visible||null==k.visible||(l.rows[_-w].visible=k.visible),l.rows[_-w].wordWrap=!!k.style&&!!k.style.wordWrap||!!C)}if(p&&(p.isCollapsed=b),r.frozenPane){var N=r.frozenPane.columns;e.isNumber(N)&&!isNaN(N)&&(l.frozenColumns=N);var E=r.frozenPane.rows;e.isNumber(E)&&!isNaN(E)&&(l.frozenRows=m&&E>0?E-1:E)}for(x=0;x<l.columnHeaders.columns.length;x++){var I=y[x],z=l.columns[x];z.isRequired=!1,I&&(I.dataType===e.DataType.Boolean&&(z.dataType=I.dataType),z.format=I.format,z.align=I.hAlign,z.wordWrap=z.wordWrap||!!I.wordWrap)}for(c=0;c<Math.max(w,1);c++)l.columnHeaders.rows.push(new e.grid.Row);var M=Object.keys(r.rows);for(c=0;c<w;c++)for(var G=0;G<r.columns.length;G++){var j=r.rows[M[c]].cells[G],O=j&&j.value||"",L=l.columnHeaders.columns[G];if(O){var P=e.xlsx.Workbook._parseExcelFormat(j);O=e.Globalize.format(O,P)}L.header=L.header||O,l.columnHeaders.setCellData(c,G,O)}if(n){var V=null==t.sheetVisible||t.sheetVisible;l.wj_sheetInfo.name=r.name,l.wj_sheetInfo.visible=!0===V||!1!==r.visible,l.wj_sheetInfo.styledCells=s,l.wj_sheetInfo.mergedRanges=i,l.wj_sheetInfo.fonts=a,l.wj_sheetInfo.tables=r.tables}}},o._getColumnHeadersHeight=function(e){if(!e&&!e.rows.length)return 0;for(var l=1,o=0;o<e.rows.length;o++){var t=e.rows[o];if(t){t.cells.forEach(function(e){l=Math.max(l,e.rowSpan||0)});break}}return l},o._escapePlainText=function(e){return""===e?"'":e&&"'"===e[0]?"'"+e:e},o._parseFlexGridRowToSheetRow=function(o,r,n,s,i,a,u,d,c,f,h,g){var x,p,m,w,b,y,_,v,C,k,S,T,R,W,A,H,F,D,B,N,E,I,z,M,G,j,O,L,P,V,U=!1,X=!1;for((B=(x=o.grid).wj_sheetInfo)&&(N=B.evaluateFormula),null==(p=o.rows[n]).recordIndex?(M=0,o.cellType===e.grid.CellType.ColumnHeader&&o.rows.length>1&&(M=n===i.length?n-1:n)):M=p.recordIndex,r.cells||(r.cells=[]),r.visible=p.isVisible,r.height=p.renderHeight||o.rows.defaultSize,r.groupLevel=f,c&&(r.collapsed=p.isCollapsed),p.wordWrap&&(r.style={wordWrap:p.wordWrap}),(p.constructor===e.grid.Row||p.constructor===e.grid._NewRowTemplate||l.softDetail()&&p.constructor===l.softDetail().DetailRow||l.softMultiRow()&&p.constructor===l.softMultiRow()._MultiRow)&&(U=!0),l.softDetail()&&p.constructor===l.softDetail().DetailRow&&(X=!0),w=0;w<o.columns.length;w++)if(b=null,D=1,F=1,P=0,z=!1,A=null,O=null,j=null,v=null,I=x._getBindingColumn(o,n,o.columns[w]),H=null,B&&o===x.cells?(W=n*o.columns.length+w,B.mergedRanges&&(H=this._getMergedRange(n,w,B.mergedRanges)),B.styledCells&&(A=B.styledCells[W])):a&&(j=this._getMeasureCell(o,w,u,d),A=(H=x.getMergedRange(o,n,w,!1))?this._getCellStyle(o,j,H.bottomRow,H.rightCol)||{}:this._getCellStyle(o,j,n,w)||{}),H||(H=x.getMergedRange(o,n,w,!1)),H?n===H.topRow&&w===H.leftCol&&(F=H.bottomRow-H.topRow+1,D=this._getColSpan(o,H,h),z=!0):z=!0,!h||h(I)){if(m=i[M]?i[M][w+s]:null,U||c?(_=z?o.getCellData(n,w,!0):null,C=z?o.getCellData(n,w,!1):null,S=!1,R=null,_&&e.isString(_)&&_.length>1&&"="===_[0]&&(S=!0),E=e.isDate(C),A&&A.format&&null!=C?(b=A.format,/[hsmyt\:]/i.test(b)&&(E=!0),y=e.xlsx.Workbook._parseCellFormat(A.format,E)):m&&m.style&&m.style.format?(b=I.format,y=m.style.format):y=null,S&&null!=N&&e.isFunction(N)&&(R=N(_)),y||(E?y="m/d/yyyy":e.isNumber(C)&&!I.dataMap?y=e.isInt(C)?"#,##0":"#,##0.00":S?(T=_.toLowerCase()).indexOf("now()")>-1?(y="m/d/yyyy h:mm",E=!0):T.indexOf("today()")>-1||T.indexOf("date(")>-1?(y="m/d/yyyy",E=!0):T.indexOf("time(")>-1&&(y="h:mm AM/PM",E=!0):y="General")):(_=z?x.columnHeaders.getCellData(0,w,!0):null,y="General"),e.isString(_)&&-1!==_.indexOf("<span")&&(v=this._parseToTextRuns(_),_=null),O=this._parseCellStyle(A)||{},o===x.cells&&c&&p.hasChildren&&w===x.columns.firstVisibleIndex){if(S&&null!=R?k=R:_?k=_:z&&(k=p.getGroupHeader().replace(/<\/?\w+>/g,"").replace(/&#39;/g,"'")),null==k&&!A)continue;!(E=e.isDate(k))&&b&&"d"===b.toLowerCase()&&e.isInt(k)&&(y="0"),k=e.isString(k)?e.xlsx.Workbook._unescapeXML(k):k,w===x.columns.firstVisibleIndex&&x.treeIndent&&(P=f),G={value:k,isDate:E,formula:S?this._parseToExcelFormula(_,E):null,colSpan:D,rowSpan:F,style:this._extend(O,{format:y,font:{bold:!0},hAlign:e.xlsx.HAlign.Left,indent:P}),textRuns:v}}else _=e.isString(_)?e.xlsx.Workbook._unescapeXML(_):_,C=e.isString(C)?e.xlsx.Workbook._unescapeXML(C):C,!E&&b&&"d"===b.toLowerCase()&&e.isInt(C)&&(y="0"),L=O&&O.hAlign?O.hAlign:m&&m.style&&null!=m.style.hAlign?e.asEnum(m.style.hAlign,e.xlsx.HAlign,!0):e.isDate(C)?e.xlsx.HAlign.Left:e.xlsx.HAlign.General,w!==x.columns.firstVisibleIndex||!x.treeIndent||L!==e.xlsx.HAlign.Left&&L!==e.xlsx.HAlign.General||(P=f),G={value:S?R:"General"===y?this._escapePlainText(_):this._escapePlainText(C),isDate:E,formula:S?this._parseToExcelFormula(_,E):null,colSpan:w<x.columns.firstVisibleIndex?1:D,rowSpan:F,style:this._extend(O,{format:y,hAlign:L,vAlign:F>1?o===x.cells||!1===x.centerHeadersVertically?e.xlsx.VAlign.Top:e.xlsx.VAlign.Center:null,indent:P}),textRuns:v},X&&(V=o.getCellElement(n,w))&&V.appendChild(p.detail);g&&g(new t(o,new e.grid.CellRange(n,w),j,u,d,G)),r.cells.push(G)}return s+w},o._parseCellStyle=function(l,o){if(void 0===o&&(o=!1),null==l)return null;var t=l.fontSize;t=t?+t.substring(0,t.indexOf("px")):null,isNaN(t)&&(t=null);var r=l.fontWeight;r="bold"===r||+r>=700;var n="italic"===l.fontStyle,s=l.textDecorationStyle;null==s&&(s=l.textDecoration),s="underline"===s;var i=l.whiteSpace;return i=!!i&&i.indexOf("pre")>-1,{font:{bold:r,italic:n,underline:s,family:this._parseToExcelFontFamily(l.fontFamily),size:t,color:l.color},fill:{color:l.backgroundColor},borders:this._parseBorder(l,o),hAlign:e.xlsx.Workbook._parseStringToHAlign(l.textAlign),wordWrap:i}},o._parseBorder=function(e,l){var o={};return o.left=this._parseEgdeBorder(e,"Left"),o.right=this._parseEgdeBorder(e,"Right"),o.top=this._parseEgdeBorder(e,"Top"),o.bottom=this._parseEgdeBorder(e,"Bottom"),l&&(o.vertical=this._parseEgdeBorder(e,"Vertical"),o.horizontal=this._parseEgdeBorder(e,"Horizontal")),o},o._parseEgdeBorder=function(l,o){var t,r=l["border"+o+"Style"],n=l["border"+o+"Width"];if(n&&n.length>2&&(n=+n.substring(0,n.length-2)),r&&"none"!==r&&"hidden"!==r){switch(t={},r=r.toLowerCase()){case"dotted":t.style=n>1?e.xlsx.BorderStyle.MediumDashDotted:e.xlsx.BorderStyle.Dotted;break;case"dashed":t.style=n>1?e.xlsx.BorderStyle.MediumDashed:e.xlsx.BorderStyle.Dashed;break;case"double":t.style=e.xlsx.BorderStyle.Double;break;default:t.style=n>2?e.xlsx.BorderStyle.Thick:n>1?e.xlsx.BorderStyle.Medium:e.xlsx.BorderStyle.Thin}t.color=l["border"+o+"Color"]}return t},o._parseBorderStyle=function(l,o,t){var r="border"+o+"Style",n="border"+o+"Width";switch(l){case e.xlsx.BorderStyle.Dotted:case e.xlsx.BorderStyle.Hair:t[r]="dotted",t[n]="1px";break;case e.xlsx.BorderStyle.Dashed:case e.xlsx.BorderStyle.ThinDashDotDotted:case e.xlsx.BorderStyle.ThinDashDotted:t[r]="dashed",t[n]="1px";break;case e.xlsx.BorderStyle.MediumDashed:case e.xlsx.BorderStyle.MediumDashDotDotted:case e.xlsx.BorderStyle.MediumDashDotted:case e.xlsx.BorderStyle.SlantedMediumDashDotted:t[r]="dashed",t[n]="2px";break;case e.xlsx.BorderStyle.Double:t[r]="double",t[n]="3px";break;case e.xlsx.BorderStyle.Medium:t[r]="solid",t[n]="2px";break;default:t[r]="solid",t[n]="1px"}},o._parseToExcelFontFamily=function(e){var l;return e&&(l=e.split(","))&&l.length>0&&(e=l[0].replace(/\"|\'/g,"")),e},o._parseToExcelFormula=function(l,o){var t,r,n,s,i,a,u,d=/\"?\w+\"?\s*\,\s*\"(\w+)\"/i;if(t=l.match(/(floor|ceiling)\([+-]?\d+\.?\d*\)/gi))for(i=0;i<t.length;i++)u=(a=t[i]).substring(0,a.lastIndexOf(")"))+", 1)",l=l.replace(a,u);if(t=null,t=l.match(/text\(\"?\w+\"?\s*\,\s*\"\w+\"\)/gi))for(i=0;i<t.length;i++)(r=(a=t[i]).match(d))&&2===r.length&&(n=r[1],/^d{1,4}?$/.test(n)||(s=e.xlsx.Workbook._parseCellFormat(n,o),u=a.replace(n,s),l=l.replace(a,u)));return l},o._parseToTextRuns=function(e){var l,o,t,r=e.split("<span "),n=[];for(l=0;l<r.length;l++)t=-1!==(o=r[l]).indexOf("</span>")?{text:o.substring(o.indexOf(">")+1,o.indexOf("</span>")),font:this._parseToTextRunFont(o.substring(o.indexOf('style="')+7,o.indexOf(';"')))}:{text:o},n.push(t);return n},o._parseToTextRunFont=function(e){var l,o,t,r,n,s,i,a,u,d=e.split(";");if(d.length>0){for(l=0;l<d.length;l++)if(2===(o=d[l].split(":")).length)switch(o[1]=o[1].trim(),o[0]){case"font-size":s=+o[1].substring(0,o[1].indexOf("px")),isNaN(s)&&(s=null);break;case"font-weight":t="bold"===o[1]||+o[1]>=700;break;case"font-style":r="italic"===o[1];break;case"text-decoration-style":case"text-decoration":n="underline"===o[1];break;case"font-family":i=this._parseToExcelFontFamily(o[1]);break;case"color":a=o[1]}u={bold:t,italic:r,underline:n,family:i,size:s,color:a}}return u},o._getMeasureCell=function(e,l,o,t){var r=t[e.cellType],n=r&&r[l],s=null==n;return n?this.hasCssText&&(n.style,n.style.cssText="",n.style.visibility="hidden"):(r||(t[e.cellType]=r=[]),r[l]=n=o.cloneNode()),!s&&n.parentElement||(e.hostElement.children.length>0?e.hostElement.children[0].appendChild(n):e.hostElement.appendChild(n)),n},o._getColumnSetting=function(l,o,t){var r=l;return null!=l.colspan&&(r=this._getRenderColumn(o,t)),r?{autoWidth:!0,width:r.renderWidth||t.defaultSize,visible:r.visible,style:{format:l.format?e.xlsx.Workbook._parseCellFormat(l.format,l.dataType===e.DataType.Date):"",hAlign:e.xlsx.Workbook._parseStringToHAlign(this._toExcelHAlign(l.getAlignment())),wordWrap:l.wordWrap}}:null},o._toExcelHAlign=function(e){return(e=e?e.trim().toLowerCase():e)?e.indexOf("center")>-1?"center":e.indexOf("right")>-1||e.indexOf("end")>-1?"right":e.indexOf("justify")>-1?"justify":"left":e},o._getColumnCount=function(l){for(var o,t=0,r=0,n=0;n<l.length;n++)(o=l[n]&&l[n].cells?l[n].cells:[])&&o.length>0&&(r=o.length,e.isInt(o[r-1].colSpan)&&o[r-1].colSpan>1&&(r=r+o[r-1].colSpan-1),r>t&&(t=r));return t},o._getRowCount=function(l,o){for(var t,r,n=l.length,s=n-1,i=0;i<o;i++)e:for(;s>=0;s--)if((r=((t=l[s])&&t.cells?t.cells:[])[i])&&(null!=r.value&&""!==r.value||e.isInt(r.rowSpan)&&r.rowSpan>1)){e.isInt(r.rowSpan)&&r.rowSpan>1&&s+r.rowSpan>n&&(n=s+r.rowSpan);break e}return n},o._numAlpha=function(e){var l=Math.floor(e/26)-1;return(l>-1?this._numAlpha(l):"")+String.fromCharCode(65+e%26)},o._getItemType=function(l){return null==l||null==l.value||isNaN(l.value)?null:e.getType(l.value)},o._setColumn=function(l,o,t){var r,n,s,i=l[o];i?(r=this._getItemType(t),i.dataType!==r&&i.dataType===e.DataType.Boolean&&r!==e.DataType.Boolean&&(i.dataType=r),!t||null==t.value||e.isString(t.value)&&e.isNullOrWhiteSpace(t.value)||(n=e.xlsx.Workbook._parseExcelFormat(t))&&i.format!==n&&"General"!==n&&(i.format=n),t&&t.style&&(t.style.hAlign&&(s=e.xlsx.Workbook._parseHAlignToString(e.asEnum(t.style.hAlign,e.xlsx.HAlign))),null==i.wordWrap?i.wordWrap=!!t.style.wordWrap:i.wordWrap=i.wordWrap&&!!t.style.wordWrap),s||r!==e.DataType.Number||(s="right"),i.hAlign=s):l[o]={dataType:this._getItemType(t),format:e.xlsx.Workbook._parseExcelFormat(t),hAlign:"",wordWrap:null}},o._getItemValue=function(l){if(null==l||null==l.value)return null;var o=l.value;return e.isString(o)&&"'"===o[0]&&(o=o.substr(1)),e.isNumber(o)&&isNaN(o)?"":o instanceof Date&&isNaN(o.getTime())?"":o},o._getCellStyle=function(e,l,o,t){try{e.grid.cellFactory.updateCell(e,o,t,l),l.className=l.className.replace("wj-state-selected",""),l.className=l.className.replace("wj-state-multi-selected","")}catch(e){return null}return window.getComputedStyle(l)},o._parseTextRunsToHTML=function(e){var l,o,t,r;for(t="",r=0;r<e.length;r++)t+=(o=(l=e[r]).font)?'<span style="'+(o.bold?"font-weight: bold;":"")+(o.italic?"font-style: italic;":"")+(o.underline?"text-decoration: underline;":"")+(o.family?"font-family: "+o.family+";":"")+(null!=o.size?"font-size: "+o.size+"px;":"")+(o.color?"color: "+o.color+";":"")+'">'+l.text+"</span>":l.text;return t},o._extend=function(l,o){for(var t in o){var r=o[t];e.isObject(r)&&l[t]?e.copy(l[t],r):l[t]=r}return l},o._checkParentCollapsed=function(e,l){var o=!1;return Object.keys(e).forEach(function(t){!0===e[t]&&!1===o&&!isNaN(l)&&+t<l&&(o=!0)}),o},o._getColSpan=function(e,l,o){for(var t=0,r=l.leftCol;r<=l.rightCol;r++)o&&!o(e.columns[r])||t++;return t},o._getRenderColumn=function(e,l){return e>=l.length?null:l[e]},o._getMergedRange=function(e,l,o){var t,r;for(t=0;t<o.length;t++)if(e>=(r=o[t]).topRow&&e<=r.bottomRow&&l>=r.leftCol&&l<=r.rightCol)return r;return null},o}();l.FlexGridXlsxConverter=o;var t=function(e){function l(l,o,t,r,n,s){var i=e.call(this,l,o)||this;return i._cell=t,i._patternCell=r,i._xlsxCell=s,i._cellsCache=n,i}return __extends(l,e),Object.defineProperty(l.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(e){this._xlsxCell=e},enumerable:!0,configurable:!0}),l.prototype.getFormattedCell=function(){return this._cell||(this._cell=o._getMeasureCell(this.panel,this.col,this._patternCell,this._cellsCache),o._getCellStyle(this.panel,this._cell,this.row,this.col)),this._cell},l}(e.grid.CellRangeEventArgs);l.XlsxFormatItemEventArgs=t})((l=e.grid||(e.grid={})).xlsx||(l.xlsx={}))}(wijmo||(wijmo={})),function(e){!function(l){l.xlsx||(l.xlsx={}),e._registerModule("wijmo.grid.xlsx",e.grid.xlsx)}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));